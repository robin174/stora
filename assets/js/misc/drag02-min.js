document.addEventListener("DOMContentLoaded",(async()=>{const t=document.querySelectorAll(".col"),e={1:"Cloud",2:"Decentralized",3:"On-Prem"},a="patBvlQ5rowJjgVUL.594d9f49ab5adfe0a3a4758c59811a0db77f41f6243c85f9df81db3b4a59ff75",n="appAVI2KWJ2K4ls6K",r="PrototypeV1";let o=[];function c(t,a,n){const r=function(t){let e="<select>";return e+='<option value="0">Please select</option>',t.forEach((t=>{e+=`<option value="${t}">${t}</option>`})),e+="</select>",e}(a.map((t=>t.provider)));t.dataset.value="0",t.innerHTML=`\n        <h3 class="provider">Select a provider</h3>\n        <h4 class="cost">$0 / TB download</h4>\n        ${r}\n        <div>\n            <label for="quantity-${t.dataset.card}">Quantity (TB):</label>\n            <input type="number" id="quantity-${t.dataset.card}" class="quantity-input" min="0" value="1">\n        </div>\n        <p class="calculated-cost">Calculated Cost: $0</p>\n    `;const o=t.querySelector("select"),c=t.querySelector(".quantity-input"),s=t.querySelector(".calculated-cost");o.addEventListener("change",(r=>{const o=r.target.value;if("0"===o)t.dataset.value="0",t.querySelector("h3.provider").textContent="Select a provider",t.querySelector("h4.cost").textContent="$0 / TB download",l(c,0,s);else{const r=a.find((t=>t.provider===o));r&&(t.dataset.value=r.price,t.querySelector("h3.provider").textContent=`${r.provider} - ${e[n]}`,t.querySelector("h4.cost").textContent=`$${r.price} / TB download`,l(c,r.price,s))}d()})),c.addEventListener("input",(()=>{const e=parseInt(t.dataset.value,10)||0;l(c,e,s),d()}))}function l(t,e,a){const n=(parseInt(t.value,10)||0)*e;a.textContent=`Calculated Cost: $${n}`}function d(){for(const[t,a]of Object.entries(e)){const e=document.querySelectorAll(`.col[data-column="${t}"] .card`);let n=0;e.forEach((t=>{const e=t.querySelector(".quantity-input"),a=parseInt(e?.value,10)||0,r=parseInt(t.dataset.value,10)||0;n+=a*r}));document.getElementById(`total-column-${t}`).textContent=`${a} cost: $${n}`}}function s(t){t.preventDefault()}function i(t){t.preventDefault();const a=t.dataTransfer.getData("text/plain"),n=document.querySelector(`.card[data-card="${a}"]`),r=t.currentTarget.dataset.column,l=e[r];t.currentTarget.appendChild(n);c(n,o.filter((t=>t.type===l)),r),d()}t.forEach((t=>{t.addEventListener("dragover",s),t.addEventListener("drop",i)})),document.querySelectorAll(".card").forEach((t=>{t.addEventListener("dragstart",(e=>{e.dataTransfer.setData("text/plain",t.dataset.card)}))})),await async function(){o=await async function(){const t=`https://api.airtable.com/v0/${n}/${r}`,e=await fetch(t,{headers:{Authorization:`Bearer ${a}`}});return e.ok?(await e.json()).records.map((t=>({id:t.id,provider:t.fields.Name,price:t.fields.DataCostStorage,type:t.fields.InfoType}))):(console.error("Failed to fetch data from Airtable"),[])}(),t.forEach((t=>{const a=t.dataset.column,n=e[a],r=o.filter((t=>t.type===n));t.querySelectorAll(".card").forEach((t=>{c(t,r,a)}))})),d()}()}));